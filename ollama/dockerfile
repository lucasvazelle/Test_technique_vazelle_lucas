FROM ubuntu:22.04

# Installer Ollama et dÃ©pendances
RUN apt-get update && apt-get install -y curl sudo
RUN curl -fsSL https://ollama.com/install.sh | sh

# Copier le Modelfile
COPY Modelfile /Modelfile

$CMD bash -c "\
    ollama serve & \
    echo 'ğŸ•’ DÃ©marrage du serveur Ollama...' && \
    until curl -s http://localhost:11434/ > /dev/null; do \
        echo 'âŒ› En attente du serveur Ollama...'; \
        sleep 1; \
    done && \
    echo 'âœ… Serveur Ollama prÃªt.' && \
    if ! ollama list | grep -q model_llama_3b; then \
        echo 'ğŸš€ CrÃ©ation du modÃ¨le model_llama_3b...'; \
        ollama create model_llama_3b -f /Modelfile; \
    else \
        echo 'ğŸ“¦ ModÃ¨le model_llama_3b dÃ©jÃ  existant.'; \
    fi && \
    wait"
